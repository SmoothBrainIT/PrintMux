services:
  backend:
    build:
      context: .
      dockerfile: docker/backend.Dockerfile
    environment:
      PRINTMUX_API_KEY: "${PRINTMUX_API_KEY:-changeme}"
      PRINTMUX_STORAGE_DIR: "/app/storage"
      PRINTMUX_DATABASE_URL: "${PRINTMUX_DATABASE_URL:-sqlite:////app/data/printmux.db}"
      PRINTMUX_CORS_ORIGINS: "${PRINTMUX_CORS_ORIGINS:-*}"
    volumes:
      - printmux_storage:/app/storage
      - printmux_data:/app/data

  frontend:
    build:
      context: .
      dockerfile: docker/frontend.Dockerfile
    environment:
      VITE_API_BASE: "${VITE_API_BASE:-http://localhost:${PRINTMUX_BACKEND_PORT:-8000}}"
    depends_on:
      - backend

volumes:
  printmux_storage:
  printmux_data:
